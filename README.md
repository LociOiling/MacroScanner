# MacroScanner
Scan a Foldit cookbook (all.macro) file and generate Lua code for GUI recipes.

    Copyright (C) 2020 LociOiling

    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with this program.  If not, see <https://www.gnu.org/licenses/>.

MacroScanner is a Python program that reads a Foldit cookbook, which is stored in the file all.macro. (The related single.macro file is also supported.)

Cookbooks contain two types of recipes: GUI and Lua. 

GUI recipes are being discontinued in 2021.

By default, MacroScanner generates the equivalent Lua code for each GUI recipe it finds. It saves each new recipe as a separate file. The saved recipes have the extension ".lua". 

MacroScanner can optionally output Lua recipes, again using the extension ".lua". MacroScanner adds various properties found in the cookbook as a comment at the beginning of each recipe, but otherwise doesn't change the content of Lua recipes.

MacroScanner lists the name and description of each recipe it finds. 

MacroScanner can be used from the command line:

usage: python MacroScanner.py [-h] [--detail] [--LuaV1] [--LuaV2] [--noGUI] [--outdir OUTDIR] [infile] [outfile]

Scan Foldit cookbook all.macro file for GUI recipes and generate Lua equivalents.

positional arguments:
  infile           an all.macro file to be scanned
  outfile          output file listing all recipes and their descriptions

optional arguments:
  -h, --help       show this help message and exit
  --detail         include details of each GUI command in Lua output
  --LuaV1          include recipes written using V1 of the Foldit Lua interface
  --LuaV2          include recipes written using V2 of the Foldit Lua interface
  --noGUI          don't include GUI recipes
  --outdir OUTDIR  output directory for the Lua files, created as needed 

MacroScanner was written and tested using Python 3.7.3, but it may be compatible with older versions of Python.

Some features of GUI recipes may result in Lua recipes which won't run without modification.

GUI recipes may be incomplete, missing various arguments. MacroScanner generates a "TODO" comment in these cases, and generates incomplete Lua code, which won't run.

GUI recipes may use the "until stopped" option when specifying a number of iterations. There is no equivalent in Lua. MacroScanner again generates a "TODO" comment, and the generated Lua code produces an error when run.

MacroScanner does not capture at least one the subtle features of GUI recipes. When using the "Local Wiggle" between frozen segments in a GUI recipe appears to wiggle all the adjacent unfrozen segments. For example, if segments 1 and 5 are frozen, GUI local wiggle of segment 2 also includes 3 and 4. The equivalent Lua generated by MacroScanner wiggles just segment 2. In this case, the Lua code runs without producing an error, but it may not find as many points as code that wiggles more segments. A "TODO" comment marks the spots that can be improved. 

MacroScanner version 1.1 adds several new features. Foldit now supports "user pick" for selecting segments or bands in a Lua recipe. Version 1.1 uses this new feature in converting GUI recipes.

Version 1.1 adds the "outdir" option, specifying the directory for the output Lua files. The directory is created if it doesn't exist. Version 1.1 also adds the "LuaV1", "LuaV2", and "noGUI" options, which control the type of recipes output.

Version 1.1 also corrects problems with the Lua generated for some options on the local wiggle command. Additionally, the single.macro variant of all.macro is supported in version 1.1.


